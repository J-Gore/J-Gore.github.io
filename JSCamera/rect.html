<html>

<head>
    <title>Test</title>

</head>

<body>
    <input type="file" accept="image/*" class="js-fileUpload" /> 
    <p class="x"></p>
    <p class="y"></p>
    <canvas class="js-uploadedImageDisplay"></canvas>
</body>

<script>
    var upload = document.querySelector(".js-fileUpload");
    var canvas = document.querySelector(".js-uploadedImageDisplay");
    var ctx = canvas.getContext("2d");
    var img = new Image();

    upload.addEventListener("change", readImage, false);


    function readImage() {
        if (this.files && this.files[0]) {
            var FR = new FileReader();
            FR.onload = function (e) {
                img.addEventListener("load", function () {
                    canvas.setAttribute("width", 2000);
                    canvas.setAttribute("height", 2000);
                    ctx.drawImage(img, 0, 0);
                });
                img.src = e.target.result;
            };
            FR.readAsDataURL(this.files[0]);
        }
    }

    function getElementOffset(el) {
        var top = 0;
        var left = 0;
        var element = el;

        // Loop through the DOM tree
        // and add it's parent's offset to get page offset
        do {
            top += element.offsetTop || 0;
            left += element.offsetLeft || 0;
            element = element.offsetParent;
        } while (element);

        return {
            top,
            left,
        };
    }

    var canvasOffset = getElementOffset(canvas);
    var offsetX = canvasOffset.left;
    var offsetY = canvasOffset.top;
    var isDragging = false;

    function handleMouseDown(e) {
        canMouseX = parseInt(e.clientX - offsetX);
        canMouseY = parseInt(e.clientY - offsetY);
        updateXY(canMouseX, canMouseY);
        // set the drag flag
        isDragging = true;
    }

    function handleMouseUp(e) {
        canMouseX = parseInt(e.clientX - offsetX);
        canMouseY = parseInt(e.clientY - offsetY);
        updateXY(canMouseX, canMouseY);
        // clear the drag flag
        isDragging = false;
    }

    function handleMouseOut(e) {
        canMouseX = parseInt(e.clientX - offsetX);
        canMouseY = parseInt(e.clientY - offsetY);
        updateXY(canMouseX, canMouseY);
        // user has left the canvas, so clear the drag flag
        //isDragging=false;
    }

    function handleMouseMove(e) {
        canMouseX = parseInt(e.clientX - offsetX);
        canMouseY = parseInt(e.clientY - offsetY);
        updateXY(canMouseX, canMouseY);
        // if the drag flag is set, clear the canvas and draw the image
        if (isDragging) {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            ctx.drawImage(img, canMouseX - img.height / 2, canMouseY - img.width / 2, img.width, img.height);
        }
    }

    function updateXY(x,y){
        var px = document.querySelector(".x");
        var py = document.querySelector(".Y");

        px.innerText = x;
        py.innerText = y;
    }

    canvas.addEventListener("mousedown", function (e) {
        console.log("mousedown");
        handleMouseDown(e); 
    });

    canvas.addEventListener("mousemove", function (e) {
        console.log("mousemove");
        handleMouseMove(e); 
    });

    canvas.addEventListener("mouseup", function (e) {
        console.log("mouseup");
        handleMouseUp(e); 
    });

    canvas.addEventListener("mouseout", function (e) {
        console.log("mouseout");
        handleMouseOut(e); 
    });
</script>

</html>